<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>README – Excel to CSV Converter for eLabFTW</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 900px;
      margin: 40px auto;
      line-height: 1.6;
      color: #333;
    }
    h1, h2, h3 {
      color: #004080;
    }
    code {
      background-color: #f2f2f2;
      padding: 2px 4px;
      border-radius: 3px;
    }
    pre {
      background-color: #f9f9f9;
      padding: 10px;
      border-left: 3px solid #ccc;
      overflow-x: auto;
    }
  </style>
</head>
<body>

  <h1>README – Excel to CSV Converter for eLabFTW</h1>

  <h2>Description</h2>
  <p>
    This R Shiny application converts Excel files (<code>.xlsx</code>) into CSV files that are compatible with <strong>eLabFTW</strong>. In addition to standard fields such as <code>title</code>, <code>content</code> and <code>tags</code>, structured JSON metadata can be generated and exported.
  </p>

  <p>
    Developed by the Data Integration Center (DIZ) and the <strong>(Bio-)Medical Data Science Group</strong> at the University Medical Center Halle.
  </p>

  <h2>Features (Version 0.13.3)</h2>
  <ul>
    <li>New: All selected content columns are now combined into a single <code>body</code> column as an HTML-formatted table</li>
    <li>New: HTML escaping of all values to prevent layout issues and security risks</li>
    <li>New: "Select all / deselect all" button for column selection</li>
    <li>All code comments translated to English</li>
  </ul>

  <h2>Features (Version 0.13.2)</h2>
  <ul>
    <li>BugFix: fixed an error that occurred when no metadata was selected for export</li>
  </ul>

  <h2>Features (Version 0.13.1)</h2>
  <ul>
    <li>Import of Excel files (.xlsx)</li>
    <li>Column selection for <code>title</code>, <code>content</code> and <code>tags</code></li>
    <li>Optional export of structured JSON metadata</li>
    <li>Field type selection for each metadata column:
      <ul>
        <li><strong>Text</strong>: free text</li>
        <li><strong>Date</strong>: automatically converted to <code>YYYY-MM-DD</code></li>
        <li><strong>Dropdown</strong>: unique values in the column used as options</li>
        <li><strong>URL</strong>: link format</li>
      </ul>
    </li>
    <li>Empty or invalid date values (<code>NA</code>, <code>NULL</code>, empty cells) are automatically cleaned</li>
    <li>Generates a CSV file with all selected fields for download</li>
  </ul>

  <h2>Step-by-Step Usage</h2>

  <ol>
    <li><strong>Upload an Excel file</strong><br>
        Upload a <code>.xlsx</code> file (UTF-8 recommended).</li>
    <li><strong>Assign columns</strong><br>
        - <code>title</code>: used as the resource name in eLabFTW<br>
        - <code>body</code>: contains all selected fields as an HTML table for the content field<br>
        - <code>tags</code>: optional keywords (defaults to "imported" if left blank)</li>
    <li><strong>Enable metadata (optional)</strong><br>
        - Select the columns to include in the metadata block<br>
        - Choose a type for each column:<br>
          <em>Text</em>, <em>Date</em>, <em>Dropdown</em>, or <em>URL</em><br>
        - Provide a group name for the metadata (e.g. "Project Info")</li>
    <li><strong>Generate and download CSV</strong></li>
  </ol>

  <h2>Example of the JSON Metadata Field</h2>

  <pre><code>{
  "elabftw": {
    "extra_fields_groups": [
      { "id": 1, "name": "Text Metadata (JSON)" }
    ]
  },
  "extra_fields": {
    "Project Start": {
      "type": "date",
      "value": "2024-03-01",
      "group_id": 1
    },
    "Category": {
      "type": "select",
      "value": "Cell Culture",
      "options": ["Cell Culture", "PCR", "Microscopy"],
      "group_id": 1
    }
  }
}
</code></pre>

  <h2>Formatting Notes</h2>
  <ul>
    <li>Supported date formats: <code>YYYY-MM-DD</code>, <code>DD.MM.YYYY</code>, <code>MM/DD/YYYY</code></li>
    <li>Empty values, <code>NA</code>, <code>NULL</code> (even as text) are filtered automatically</li>
    <li>For <strong>Dropdown</strong> types, all unique values in the selected column will be used as options</li>
    <li>The generated <code>metadata</code> column follows the format expected by eLabFTW during CSV import</li>
  </ul>


  <h2>Contact</h2>
  <p>
    <strong>Christian Jaeger</strong><br>
    University Medicine Halle<br>
    E-mail: <a href="mailto:christian.jaeger@uk-halle.de">christian.jaeger@uk-halle.de</a><br>
    Additional Documentation in intranet: <a href="https://confluence.uk-halle.de/x/wpUbD" target="_blank">Confluence link</a>
  </p>

</body>
</html>
